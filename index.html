<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Semantic Sorter</title>
</head>

<body class="bg-slate-900 text-white min-h-screen p-8">
  <div id="app" class="max-w-[95%] mx-auto space-y-8">
    <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">
      Semantic Sorter
    </h1>

    <div class="space-y-4">
      <p class="text-slate-400">
        Enter entities below (one per line). They will be sorted semantically using WebGPU embeddings and a TSP solver.
      </p>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div class="space-y-4">
          <h2 class="text-xl font-semibold text-blue-300">Input Entities</h2>
          <textarea id="input-text"
            class="w-full h-96 bg-slate-800 border border-slate-700 rounded-xl p-4 text-slate-200 focus:ring-2 focus:ring-blue-500 outline-none resize-none font-mono text-sm leading-relaxed"
            placeholder="Tokyo&#10;Paris&#10;London&#10;New York&#10;Kyoto&#10;Berlin&#10;Osaka">
Above-ground biomass/carbon stock estimates
Riparian land cover change maps
Restoration area maps
Ozone concentration data
Fishing vessel distribution (inferred from VMS/AIS + EO)
Habitat condition maps
Composite index maps based on EO-derived variables
Contaminated site maps (indirect)
Habitat distribution maps
Habitat change maps (loss of wetlands, deforestation)
Ecosystem extent maps
High-resolution habitat maps
Hazard monitoring maps
High-resolution forest cover maps
Disturbance indicators
Annual deforestatiofforestation rates
Drought monitoring
Disturbance maps
Distribution maps of specific invasive plant species
Habitat fragmentation maps
Global and regional surface temperature datasets
Coral reef health maps (bleaching extent)
Habitat fragmentation maps
Oil spill detection maps
Oceanic fronts maps
Plume tracking for transboundary transport
Ozone layer thickness data (global and regional maps)
Pollution distribution maps (indirect)
Habitat characteristics maps
Maps of potential ASGM activity
Time-series change maps
Green space maps
Habitat fragmentation analysis
Marine ecosystem maps
Maps of potential illegal waste sites
Net Primary Production (NPP) maps
Maps showing areas with changes in vegetation composition or health potentially linked to invasive species
Degradation hotspot maps
Mining area expansion maps
Maps of key habitats in drylands
Ocean productivity maps
Oceanographic parameter maps
Ocean temperature profiles
          </textarea>
          <button id="sort-btn"
            class="w-full py-3 px-6 bg-blue-600 hover:bg-blue-500 rounded-lg font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2">
            <span>Sort Entities</span>
          </button>
          <div id="status" class="text-sm text-slate-400 min-h-[1.5em]"></div>
        </div>

        <div class="space-y-4">
          <h2 class="text-xl font-semibold text-green-300">Sorted Result</h2>
          <div id="output-list"
            class="w-full h-96 bg-slate-800/50 border border-slate-700/50 rounded-xl p-4 overflow-y-auto space-y-2 relative">
            <div class="absolute inset-0 flex items-center justify-center text-slate-600 pointer-events-none"
              id="empty-state">
              Result will appear here...
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="max-w-[95%] mx-auto space-y-8 pb-12 mt-12">
    <!-- Visualization Section -->
    <div class="space-y-4">
      <div class="flex flex-wrap items-center justify-between gap-4">
        <h2 class="text-xl font-semibold text-blue-300">Semantic Map</h2>
        <div class="flex flex-wrap gap-4 text-sm bg-slate-800 p-2 rounded-lg border border-slate-700 items-center">
          <div class="flex gap-4 pr-4 border-r border-slate-700">
            <label class="flex items-center gap-2 cursor-pointer hover:text-blue-300"><input type="checkbox"
                id="layer-points" checked class="accent-blue-500"> Points</label>
            <label class="flex items-center gap-2 cursor-pointer hover:text-blue-300"><input type="checkbox"
                id="layer-lines" checked class="accent-blue-500"> Lines</label>
            <label class="flex items-center gap-2 cursor-pointer hover:text-blue-300"><input type="checkbox"
                id="layer-pt-labels" checked class="accent-blue-500"> Labels</label>
            <label class="flex items-center gap-2 cursor-pointer hover:text-blue-300"><input type="checkbox"
                id="layer-ln-scores" class="accent-blue-500"> Sim Scores</label>
            <label class="flex items-center gap-2 cursor-pointer hover:text-blue-300"><input type="checkbox"
                id="layer-arrows" class="accent-blue-500"> Arrows</label>
          </div>
          <div class="flex gap-4 items-center">
            <div class="flex items-center gap-2">
              <span class="text-slate-400">Radius</span>
              <input type="range" id="param-radius" min="1" max="20" value="5" class="w-16 accent-blue-500">
            </div>
            <div class="flex items-center gap-2">
              <span class="text-slate-400">Width</span>
              <input type="range" id="param-linewidth" min="1" max="10" value="2" class="w-16 accent-blue-500">
            </div>
          </div>
          <button id="btn-fullscreen"
            class="p-1 hover:bg-slate-700 rounded text-slate-400 hover:text-white transition-colors"
            title="Toggle Fullscreen">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3" />
            </svg>
          </button>
        </div>
      </div>
      <div id="deck-container">
        <canvas id="deck-canvas"></canvas>
      </div>
    </div>
    <div class="flex items-center justify-between">
      <h2 class="text-xl font-semibold text-purple-300">Debug: Distance Matrix</h2>
      <div class="flex items-center gap-4 bg-slate-800 px-4 py-2 rounded-lg border border-slate-700">
        <label for="sim-threshold" class="text-sm text-slate-400">Color Threshold:</label>
        <input type="range" id="sim-threshold" min="0" max="1" step="0.01" value="0.8" class="w-32 accent-purple-500">
        <span id="sim-threshold-val" class="text-sm font-mono text-purple-400 w-12 text-right">0.80</span>
      </div>
    </div>
    <div class="overflow-x-auto bg-slate-800 border border-slate-700 rounded-xl p-4">
      <table id="matrix-table" class="w-full text-left text-sm text-slate-400">
        <thead class="text-xs text-slate-200 uppercase bg-slate-700/50">
          <tr></tr>
        </thead>
        <tbody>
          <tr>
            <td class="p-4 text-center">Matrix will appear here after sorting...</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <script type="module" src="/src/main.ts"></script>
</body>

</html>